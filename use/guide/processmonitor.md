# 进程监控

## 功能概述

CloudWatch 进程监控功能允许您对云主机（UHost）和裸金属云主机（UPhost）上运行的关键业务进程进行持续性监控。您可以通过设置**进程关键字**或**端口号**来匹配目标进程，并实时查看其存活状态、CPU、内存等资源消耗指标。您可以配置告警策略，以便在进程异常时及时接收通知，保障业务稳定运行。

## 功能详解

### 进程匹配方式详解

| 匹配方式       | 说明                                                         | 适用场景                 | 示例                                                         |
| :------------- | :----------------------------------------------------------- | :----------------------- | :----------------------------------------------------------- |
| **进程关键字** | 通过进程的名称、路径或参数进行匹配。<br />**模糊匹配**：命令行中包含关键词即匹配。<br />**精确匹配**：命令行必须与关键词完全相同才匹配。 | 监控特定的应用服务。     | 关键字 `java`（模糊匹配）：匹配所有命令行中包含 “java” 的进程。<br />关键字 `/usr/bin/nginx`（精确匹配）：只匹配路径为此绝对路径的进程。 |
| **端口号**     | 通过进程监听的网络端口进行**精确匹配**。                     | 监控绑定特定端口的服务。 | 端口号 `8080`：匹配所有监听8080端口的进程。                  |

> **最佳实践**：
>
> - 为避免匹配到过多无关进程，建议使用**更精确的关键字**。例如，用 `nginx: master process`代替 `nginx`。
> - 单个采集任务最多可添加**10个**匹配值（关键字或端口号），它们之间的关系是“或”（OR）。

### 监控数据解读

![](https://www-s.ucloud.cn/2025/09/7c53778bf4c912c9b3b83e6f40400031_1758190954296.png)

#### 1. 匹配进程数图表

- 图表展示了**不同时刻**、**不同匹配值**所命中的进程数量。
- 您可以通过此图表分析进程的启动、停止和重启行为，判断服务是否稳定。

#### 2. 列表数据

选中不同匹配值卡片可查看该匹配值命中的进程详情。

- **进程ID：**即PID。 是操作系统为每个正在运行的进程分配的唯一身份标识号。

- **command：**启动这个进程时所执行的完整命令行字符串

- **CPU使用率/内存使用率/打开文件数**：所选时间范围内，该进程最后一次上报的瞬时值。

- **上报时间**：所选择的时间范围内，该进程最后一次成功采集到数据并上报到服务器的时间。如果时间过旧，可能表示Agent通信异常或进程已消失。

- **操作：**点击可查看单个进程指定时间范围内的 CPU使用率/ 内存使用率/ 打开文件数 趋势图。

  ![](https://www-s.ucloud.cn/2025/09/15e237f793cf9bf36c5761ef79bb6e57_1758190954287.png)

### 监控指标说明

进程监控功能采集并展示以下四个指标，帮助用户全面了解目标进程的运行状态与资源消耗情况。

| 指标                       | 含义                         | 数据维度                                    |
| :------------------------- | :--------------------------- | :------------------------------------------ |
| **匹配进程数**             | 符合匹配规则的进程有多少个   | 匹配值 (`task_id`+`keyword`)                |
| **CPU使用率（进程维度）**  | 单个进程的CPU消耗占比        | 进程 (`task_id`+`keyword`+`pid`+ `cmdline`) |
| **内存使用率（进程维度）** | 单个进程的内存消耗占比       | 进程 (`task_id`+`keyword`+`pid`+ `cmdline`) |
| **打开文件数（进程维度）** | 单个进程打开的文件描述符数量 | 进程 (`task_id`+`keyword`+`pid`+ `cmdline`) |

### 常见问题（FAQ）

**Q1: 为什么我配置了关键字，却看不到进程数据？**

1. **确认Agent状态**：首先检查目标主机是否已安装Uboltagent且运行正常。
2. **确认匹配规则**：您的关键字或端口号是否正确？尝试使用 `ps aux | grep [关键字]`命令在主机上验证是否能匹配到进程。
3. **确认进程状态**：您查看数据时，进程是否正在运行？
4. **匹配数量限制**：单个关键字每个采集这周期最多采集前15个匹配的进程（按PID排序）。如果未匹配到，请尝试使用更精确的关键字。

**Q2: “精确匹配”和“模糊匹配”有什么区别？**

- `模糊匹配``java`：会匹配 `java -jar app.jar`、`/usr/bin/java`等。
- `精确匹配``java`：只会匹配命令行恰好是 `java`的进程（极为罕见）。通常**精确匹配需要填写完整的进程路径**，例如 `/usr/bin/java`。

**Q3: 我能监控Windows主机上的进程吗？**

当前版本仅支持Linux系统的进程监控。